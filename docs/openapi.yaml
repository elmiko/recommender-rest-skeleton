---
swagger: "2.0"
info:
  description: "The REST API for the Jiminy Recommender"
  version: "0.0.1"
  title: "Jiminy Recommender REST Server"
consumes:
- "application/json"
produces:
- "application/json"

definitions:
  SingleError:
    description: |-
      A single error generated by the server
    properties:
      status:
        description: |-
          HTTP status code
        type: integer
        format: int32
      title:
        description: |-
          A brief summary of the error, this should remain consistent
          between errors of the same class
        type: string
      details:
        description: |-
          An explanation of the specific error that has occurred
        type: string
    required:
      - status
      - title
      - details
  ErrorResponse:
    description: |-
      A list of errors to be returned in an HTTP response
    properties:
      errors:
        description: |-
          List of errors returned
        type: array
        minItems: 1
        items:
          $ref: "#/definitions/SingleError"
    required:
      - errors
  ServerInfo:
    description: |-
      General information about the server application
    properties:
      application:
        properties:
          name:
            description: |-
              Application name
            type: string
          version:
            description: |-
              Application version
            type: string
        required:
          - name
          - version
    required:
      - application
  PredictionRatingsRequest:
    description: |-
      A Request for new ratings predictions
    properties:
      user:
        description: |-
          The user identifier for the prediction
        type: string
      products:
        description: |-
          An array of product identifiers for prediction
        type: array
        minItems: 1
        items:
          type: string
    required:
      - user
      - products
  PredictionRatingsResponse:
    description: |-
      Information about a specific prediction request
    properties:
      prediction:
        properties:
          user:
            description: |-
              The user identifier for the prediction
            type: string
          id:
            description: |-
              A unique identifier for this prediction set
            type: string
          products:
            description: |-
              A list of the ratings per product
            type: array
            minItems: 0
            items:
              properties:
                id:
                  description: |-
                    The product identifier for this prediction
                  type: string
                rating:
                  description: |-
                    The predicted rating for this product
                  type: number
                  format: float
              required:
                - id
                - rating
        required:
          - user
          - id
          - products
  PredictionRankingsRequest:
    description: |-
      A Request for new top-k predictions
    properties:
      user:
        description: |-
          The user identifier for the prediction
        type: string
      topk:
        description: |-
          The number of top ratings required
        type: integer
        minimum: 1
    required:
      - user
      - topk
  PredictionRankingsResponse:
    description: |-
      Information about a specific ranking prediction request
    properties:
      prediction:
        properties:
          user:
            description: |-
              The user identifier for the prediction
            type: string
          id:
            description: |-
              A unique identifier for this prediction set
            type: string
          topk:
            description: |-
              The number of top ranking products request
            type: integer
            minimum: 1
          products:
            description: |-
              A (ordered) list of the ratings per product
            type: array
            minItems: 0
            items:
              properties:
                id:
                  description: |-
                    The product identifier for this prediction
                  type: string
                rating:
                  description: |-
                    The predicted rating for this product
                  type: number
                  format: float
              required:
                - id
                - rating
        required:
          - user
          - id
          - topk
          - products
paths:
  /:
    get:
      description: |-
        Returns information about the server version
      operationId: getServerInfo
      tags:
        - server
      responses:
        "200":
          description: |-
            Valid server info response
          schema:
            $ref: "#/definitions/ServerInfo"
          examples:
            application/json:
              application:
                name: jiminy-recommender
                version: 0.0.0
        default:
          description: |-
            Unexpected error
          schema:
            $ref: "#/definitions/ErrorResponse"
  /predictions/ratings:
    post:
      description: |-
        Request a new ratings prediction
      operationId: postRatingsPredictions
      tags:
        - predictions
      parameters:
        - name: ratingPredictionRequest
          in: body
          description: |-
            a request for a new ratings prediction
          required: true
          schema:
            $ref: "#/definitions/PredictionRatingsRequest"
      responses:
        "201":
          description: |-
            Prediction received response
          schema:
            $ref: "#/definitions/PredictionRatingsResponse"
          examples:
            application/json:
              prediction:
                user: 12345
                id: 1
                products: []
                type: "rating"
        default:
          description: |-
            Unexpected error
          schema:
            $ref: "#/definitions/ErrorResponse"
  /predictions/ratings/{id}:
    parameters:
      - name: id
        in: path
        description: |-
          The unique identifier for the ratings prediction
        required: true
        type: string
    get:
      description: |-
        Return detailed information about a specific prediction
      operationId: getRatingsPrediction
      tags:
        - predictions
      responses:
        "200":
          description: |-
            Prediction detailed response
          schema:
            $ref: "#/definitions/PredictionRatingsResponse"
          examples:
            application/json:
              prediction:
                user: 12345
                id: 1
                products:
                  - id: 6789
                    rating: 3.5
        default:
          description: |-
            Unexpected error
          schema:
            $ref: "#/definitions/ErrorResponse"
  /predictions/ranks:
    post:
      description: |-
        Request a new top-k prediction
      operationId: postRankingPredictions
      tags:
        - predictions
      parameters:
        - name: rankingPredictionRequest
          in: body
          description: |-
            a request for a new prediction
          required: true
          schema:
            $ref: "#/definitions/PredictionRankingsRequest"
      responses:
        "201":
          description: |-
            Prediction received response
          schema:
            $ref: "#/definitions/PredictionRankingsResponse"
          examples:
            application/json:
              prediction:
                user: 12345
                id: 1
                topk: 10
        default:
          description: |-
            Unexpected error
          schema:
            $ref: "#/definitions/ErrorResponse"
  /predictions/ranks/{id}:
    parameters:
      - name: id
        in: path
        description: |-
          The unique identifier for the top-k prediction
        required: true
        type: string
    get:
      description: |-
        Return detailed information about a specific prediction
      operationId: getPrediction
      tags:
        - predictions
      responses:
        "200":
          description: |-
            Prediction detailed response
          schema:
            $ref: "#/definitions/PredictionRankingsResponse"
          examples:
            application/json:
              prediction:
                user: 12345
                id: 1
                products:
                  - id: 6789
                    rating: 3.5
                topk: 1
        default:
          description: |-
            Unexpected error
          schema:
            $ref: "#/definitions/ErrorResponse"

